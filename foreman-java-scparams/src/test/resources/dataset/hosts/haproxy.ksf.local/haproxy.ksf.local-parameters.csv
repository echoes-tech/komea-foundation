puppetModule,puppetClass,parameter,value,usePuppetDefault
sysctl,sysctl::values,args,"{""net.ipv4.ip_forward"":{""value"":1},""net.ipv4.conf.all.accept_source_route"":{""value"":0},""net.ipv4.conf.all.accept_redirects"":{""value"":0},""net.ipv4.icmp_echo_ignore_broadcasts"":{""value"":1},""net.ipv4.icmp_ignore_bogus_error_responses"":{""value"":1}}",false
wrappers,wrappers::concat,resources,"{""/var/lib/haproxy/ksf.pem"":{""owner"":""haproxy"",""group"":""haproxy"",""mode"":""0600""}}",false
wrappers,wrappers::concat::fragment,resources,"{""haproxy_cert"":{""target"":""/var/lib/haproxy/ksf.pem"",""source"":""/etc/ssl/certs/ksf.crt"",""order"":""01""},""haproxy_key"":{""target"":""/var/lib/haproxy/ksf.pem"",""source"":""/etc/ssl/certs/ksf.key"",""order"":""02""}}",false
wrappers,wrappers::file,resources,"\""/root/.ssh/id_rsa\"":\r\n  ensure: file\r\n  mode: '0600'\r\n  content: <%= @host.params['id_dsa'] %>\r\n\""/root/.ssh/id_rsa.pub\"":\r\n  ensure: file\r\n  mode: '0644'\r\n  content: <%= @host.params['id_dsa.pub'].split(@host.shortname + \"": \"")[1].split(\""\\n\"")[0] %>\r\n/var/backups/<%= @host.domain %>:\r\n  ensure: directory\r\n<%= params = \""\\n  ensure: directory\\n  owner: backupninja\\n  group: backupninja\""; @host.params['id_dsa.pub'].gsub!(/(\\w+):.*/, '\""/var/backups/ksf.local/\\1\"":' + params + \""\\n\"" + '\""/var/backups/ksf.local/\\1/rdiff-backup\"":' + params) %>\r\n\""/etc/dhcp/dhclient-enter-hooks.d/nodnsupdate\"":\r\n  ensure: file\r\n  mode: '755' \r\n  content: \""#!/bin/sh\\nmake_resolv_conf(){\\n        :\\n}\""",false
wrappers,wrappers::firewall,resources,"{""110 Accept related established rules"":{""chain"":""FORWARD"",""proto"":""all"",""state"":[""RELATED"",""ESTABLISHED""],""action"":""accept""},""111 Drop invalid state packets"":{""chain"":""FORWARD"",""proto"":""all"",""state"":""INVALID"",""action"":""drop""},""150 allow Munin-Node access"":{""dport"":""munin"",""proto"":""tcp"",""action"":""accept""},""150 allow Munin-Node access - IPv6"":{""dport"":""munin"",""proto"":""tcp"",""action"":""accept"",""provider"":""ip6tables""},""200 allow HTTP and HTTPs access"":{""dport"":[80,443],""proto"":""tcp"",""action"":""accept""},""200 allow HTTP and HTTPs access - IPv6"":{""dport"":[80,443],""proto"":""tcp"",""action"":""accept"",""provider"":""ip6tables""},""201 allow Foreman DHCP"":{""iniface"":""eth1"",""proto"":""udp"",""dport"":67,""destination"":""255.255.255.255"",""action"":""accept""},""202 allow dynamic IP (DHCP)"":{""table"":""nat"",""chain"":""POSTROUTING"",""outiface"":""eth0"",""proto"":""all"",""jump"":""MASQUERADE""},""203 allow dynamic IP (DHCP)"":{""chain"":""FORWARD"",""outiface"":""eth0"",""iniface"":""eth1"",""proto"":""all"",""source"":""192.168.122.0/24"",""ctstate"":""NEW"",""action"":""accept""},""206 Redirect tftp (udp/69) to Foreman (192.168.122.254)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""udp"",""dport"":69,""jump"":""DNAT"",""todest"":""192.168.122.254""},""207 Redirect tftp (udp/69) to Foreman (192.168.122.254)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""udp"",""dport"":69,""outiface"":""eth1"",""destination"":""192.168.122.254"",""ctstate"":""NEW"",""action"":""accept""},""208 Redirect noVNC (tcp/5910-5930) to Foreman (192.168.122.254)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":""5910-5930"",""jump"":""DNAT"",""todest"":""192.168.122.254""},""209 Redirect noVNC (tcp/5910-5930) to Foreman (192.168.122.254)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":""5910-5930"",""outiface"":""eth1"",""destination"":""192.168.122.254"",""ctstate"":""NEW"",""action"":""accept""},""210 Redirect tcp/8065 to Mattermost (192.168.122.11)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":8065,""jump"":""DNAT"",""todest"":""192.168.122.11""},""211 Redirect tcp/8065 to Mattermost (192.168.122.11)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":8065,""outiface"":""eth1"",""destination"":""192.168.122.11"",""ctstate"":""NEW"",""action"":""accept""},""212 Redirect tcp/5001 to Activity (192.168.122.9)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":5001,""jump"":""DNAT"",""todest"":""192.168.122.9:443""},""213 Redirect tcp/5001 to Activity (192.168.122.9)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":443,""outiface"":""eth1"",""destination"":""192.168.122.9"",""ctstate"":""NEW"",""action"":""accept""},""214 Redirect tcp/6969 to Activity (192.168.122.9)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":6969,""jump"":""DNAT"",""todest"":""192.168.122.9""},""215 Redirect tcp/6969 to Activity (192.168.122.9)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":6969,""outiface"":""eth1"",""destination"":""192.168.122.9"",""ctstate"":""NEW"",""action"":""accept""},""216 Redirect Smart-Proxy API (tcp/8443) to Foreman (192.168.122.254)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":8443,""jump"":""DNAT"",""todest"":""192.168.122.254""},""217 Redirect Smart-Proxy API (tcp/8443) to Foreman (192.168.122.254)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":8443,""outiface"":""eth1"",""destination"":""192.168.122.254"",""ctstate"":""NEW"",""action"":""accept""},""218 Redirect Puppet (tcp/8140) to Foreman (192.168.122.254)"":{""table"":""nat"",""chain"":""PREROUTING"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":8140,""jump"":""DNAT"",""todest"":""192.168.122.254""},""219 Redirect Puppet (tcp/8140) to Foreman (192.168.122.254)"":{""chain"":""FORWARD"",""iniface"":""eth0"",""proto"":""tcp"",""dport"":8140,""outiface"":""eth1"",""destination"":""192.168.122.254"",""ctstate"":""NEW"",""action"":""accept""},""300 allow all forward on eth1"":{""chain"":""FORWARD"",""proto"":""all"",""iniface"":""eth1"",""outiface"":""eth1"",""action"":""accept""}}",false
wrappers,wrappers::haproxy::backend,resources,"Foreman:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ https://foreman.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    rspirep: \""(.*)foreman.ksf.local(.*) \\\\1ksf-dev.metrixware.local\\\\2\""\r\n    http-request:\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS * HTTP/1.1\\r\\nHost:\\ foreman\r\n    balance: roundrobin\r\n    server: foreman 192.168.122.254:443 ssl check inter 1000 verify none\r\nNexus:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://nexus.ksf.local:8081(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    option:\r\n    - httpchk OPTIONS /nexus HTTP/1.1\\r\\nHost:\\ nexus\r\n    http-request:\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    balance: roundrobin\r\n    server: nexus 192.168.122.15:8081 check inter 1000 verify none\r\nNexus211:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://nexus211.ksf.local:8081(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    option:\r\n    - httpchk OPTIONS /nexus211 HTTP/1.1\\r\\nHost:\\ nexus211\r\n    http-request:\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    balance: roundrobin\r\n    server: nexus211 192.168.122.6:8081 check inter 1000 verify none\r\nMunin:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://munin.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    option:\r\n    - httpchk OPTIONS * HTTP/1.1\\r\\nHost:\\ munin\r\n    http-request:\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    balance: roundrobin\r\n    server: munin 192.168.122.13:80 check inter 1000 verify none\r\nJenkins:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://jenkins.ksf.local:8080(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /jenkins HTTP/1.1\\r\\nHost:\\ jenkins\r\n    balance: roundrobin\r\n    server: jenkins 192.168.122.25:8080 check inter 1000 verify none\r\nCAS:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://cas.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host cas.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /cas-overlay-1.0 HTTP/1.1\\r\\nHost:\\ cas\r\n    balance: roundrobin\r\n    server: cas 192.168.122.14:8080 check inter 1000 verify none\r\nActivity:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ https://redmine.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk HEAD /redmine HTTP/1.1\\r\\nHost:\\ redmine\r\n    balance: roundrobin\r\n    server: redmine 192.168.122.9:443 ssl check inter 1000 verify none\r\nFoundation:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://foundation.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host foundation.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /foundation HTTP/1.1\\r\\nHost:\\ foundation\r\n    balance: roundrobin\r\n    server: foundation 192.168.122.17:8888 check inter 1000 verify none\r\nDashboard:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://dashboard.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host dashboard.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS / HTTP/1.1\\r\\nHost:\\ dashboard\r\n    balance: roundrobin\r\n    server: dashboard 192.168.122.3:8080 check inter 1000 verify none\r\nZuul:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://dashboard.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host dashboard.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /api/dashboard HTTP/1.1\\r\\nHost:\\ dashboard\r\n    balance: roundrobin\r\n    server: dashboard 192.168.122.3:8081 check inter 1000 verify none\r\nBsc:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://dashboard.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host dashboard.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /bsc HTTP/1.1\\r\\nHost:\\ dashboard\r\n    balance: roundrobin\r\n    server: dashboard 192.168.122.3:9000 check inter 1000 verify none\r\nAdminServer:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://dashboard.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host dashboard.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /admin-server HTTP/1.1\\r\\nHost:\\ dashboard\r\n    balance: roundrobin\r\n    server: dashboard 192.168.122.3:8089 check inter 1000 verify none\r\nKibana:\r\n  options:\r\n    mode: http\r\n    rspirep: \""^Location:\\\\ http://dashboard.ksf.local(.*)    Location:\\\\ <%= @host.params['url_base_usine'] %>\\\\1\""\r\n    http-request:\r\n    - set-header Host dashboard.ksf.local\r\n    - set-header X-Forwarded-Proto https\r\n    - set-header X-Forwarded-Port 443\r\n    option:\r\n    - httpchk OPTIONS /kibana HTTP/1.1\\r\\nHost:\\ dashboard\r\n    balance: roundrobin\r\n    server: dashboard 192.168.122.3:5601 check inter 1000 verify none",false
wrappers,wrappers::haproxy::frontend,resources,"{""HTTP"":{""ipaddress"":[""*""],""ports"":[80],""mode"":""http"",""options"":{""redirect"":""scheme https code 301 if !{ ssl_fc }"",""timeout client"":""30s"",""option"":[""forwardfor""]}},""HTTPs"":{""bind"":{""*:443"":[""ssl"",""no-sslv3"",""ciphers EECDH+aRSA+AES:TLSv1+kRSA+AES:TLSv1+kRSA+3DES"",""crt /var/lib/haproxy/ksf.pem""]},""mode"":""http"",""options"":{""acl"":[""aclusr_path_starts_with_cas url_beg /cas-overlay-1.0"",""aclusr_path_starts_with_foreman url_beg /foreman"",""aclusr_path_starts_with_foundation url_beg /foundation"",""aclusr_path_starts_with_jenkins url_beg /jenkins"",""aclusr_path_starts_with_munin url_beg /munin"",""aclusr_path_starts_with_nexus211 url_beg /nexus211"",""aclusr_path_starts_with_nexus url_beg /nexus"",""aclusr_path_starts_with_activity url_beg /redmine"",""aclusr_path_starts_with_api_dashboard url_beg /api/dashboard"",""aclusr_path_starts_with_bsc url_beg /bsc"",""aclusr_path_starts_with_admin_server url_beg /admin-server"",""aclusr_path_starts_with_kibana url_beg /kibana""],""use_backend"":[""Activity if aclusr_path_starts_with_activity"",""CAS if aclusr_path_starts_with_cas"",""Foreman if aclusr_path_starts_with_foreman"",""Foundation if aclusr_path_starts_with_foundation"",""Jenkins if aclusr_path_starts_with_jenkins"",""Nexus211 if aclusr_path_starts_with_nexus211"",""Nexus if aclusr_path_starts_with_nexus"",""Munin if aclusr_path_starts_with_munin"",""Zuul if aclusr_path_starts_with_api_dashboard"",""Bsc if aclusr_path_starts_with_bsc"",""AdminServer if aclusr_path_starts_with_admin_server"",""Kibana if aclusr_path_starts_with_kibana""],""default_backend"":""Dashboard"",""timeout client"":""30s"",""option"":[""forwardfor""]}}}",false
wrappers,wrappers::openssl::certificate::x509,resources,"{""ksf"":{""ensure"":""present"",""country"":""FR"",""organization"":""Echoes"",""commonname"":""ksf-dev.metrixware.local"",""locality"":""Nanterre"",""unit"":""IT"",""email"":""contact@echoes.fr"",""days"":0}}",false
